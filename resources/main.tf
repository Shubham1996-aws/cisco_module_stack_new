########################################################################################################
########################################################################################################
########################################################################################################
# VPC Creation #
module "vpc" {
  source = "../modules/aws/vpc"
  instanceCount = var.instanceCount
  
}


########################################################################################################
########################################################################################################
########################################################################################################
# S3 Creation #
module "s3" {
  source = "../modules/aws/s3"
  bucket_name = var.bucket_name
}

########################################################################################################
########################################################################################################
########################################################################################################
# iam Creation #
module "iam" {
  source = "../modules/aws/iam"
}

########################################################################################################
########################################################################################################
########################################################################################################

module "stack_1" {
  source = "../modules/aws/ec2"
  instance_type = var.instance_type
  instanceCount = var.instanceCount ## no of instance
  subnet_id = module.vpc.subnet_id
  depends_on    = [module.vpc, module.iam]
}

########################################################################################################
########################################################################################################
########################################################################################################


module "stack_2" {
  source = "../modules/aws/ec2"
  instance_type = var.instance_type
  instanceCount = var.instanceCount ## no of instance
  subnet_id = module.vpc.subnet_id
  depends_on    = [module.vpc, module.iam]
}
########################################################################################################
########################################################################################################
########################################################################################################


module "stack_3" {
  source = "../modules/aws/ec2"
  instance_type = var.instance_type
  instanceCount = var.instanceCount ## no of instance
  subnet_id = module.vpc.subnet_id 
  depends_on    = [module.vpc, module.iam]
}
########################################################################################################
########################################################################################################
########################################################################################################

module "stack_4" {
  source = "../modules/aws/ec2"
  instance_type = var.instance_type
  instanceCount = var.instanceCount ## no of instance
  subnet_id = module.vpc.subnet_id
  depends_on    = [module.vpc, module.iam]
  
}
########################################################################################################
########################################################################################################
########################################################################################################
